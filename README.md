# BGPSecX: a Software-Defined Networking approach to enhance BGP security

## Introduction

BGPSecX is an SDN-based architecture to make origin authetication and path validation to enhance BGP security, and have as targets the Internet Exchange Points (IXP). Includes secure communication channels between IXPs to enable collaboration. SDN shifts the computational burden from routers to the logically-centralised controller, while enabling BGP not to be changed. Targeting IXPs and promoting inter-IXP collaboration enables hard-to-obtain security guarantees (such as path validation) and the creation of incentives to foster adoption of BGP security services. To ensure several security aspects, It uses blockchain as main database.

To validate the effectiveness and the potential value of BGPSecX we performed simulations using public BGP and IXP data. The objective is to assess empirically how BGPSECx compares with existing solutions in terms of security. Thus, this document brings information of how to replicate the evaluation tests using simulation process from empiracal data.

## Datasets

For the simulation we uses three datatasets. First, is the peering interconnections. For this, we have gathered IXP data from PeeringDB project. We imported only information from IXPs which had more than 50 peers (the largest IXP in our dataset had 731 participants). This filtering resulted in 68 IXPs, and the total number of ASes connected to these 68 IXPs adds up to 4147. To analyse also partial adoption by ASes, we divide this dataset into six subsets as follows: ASes-1%, ASes-10%, ASes-25%, ASes-50%, ASes-75%, ASes-100%. The first considers that only 1% of the ASes adhere to BGPSecX; the second, 10%; etc. This selection is made randomly (the ASes from the dataset), and the randomisation process is run 10 times. In the following, we call this group of 6 datasets the **IXP-dataset**

The second source of information we need for our simulation is BGP routing data – the **Routing-dataset**. This is the routing information exchanged between BGP peers that is present in the Network Layer Reachability Information (NLRI) attribute of the BGP UPDATE messages. To obtain these data we resorted to the Routing Information Service of RIPE NCC, through the Route Information Service (RIS).

For Routing-dataset We have gathered data from all available collectors on September 1st, 2016, during a 24-hour period. From this dataset we removed repeated BGP updates records. We used 18 collector as shows in the table below:


| Dataset | # Updates | # Prefixes | Collector | Locality |
| ------- | --------- | ---------- | --------- | -------- |
| RRC00 | 1176888 | 5886175 | RIPE NCC | Amsterdam/NL |
| RRC01 | 642095 | 3219512 | LINX | London/UK |
| RRC03 | 802181 | 4021230 | AMS-IX/NL-IX | Amsterdam/NL |
| RRC04 | 610684 | 2711758 | CIXP/CERN | Geneva/CH |
| RRC05 | 463082 | 2133931 | VIX | Vienna/AT |
| RRC06 | 141904 | 590750 | JPIX | Otemachi/JP |
| RRC07 | 918238 | 3350961 | NETNOD | Stockholm/SE |
| RRC10 | 762713 | 3288810 | MIX | Milan/IT |
| RRC11 | 897104 | 4344049 | NYIIX | New York/US |
| RRC12 | 1524949 | 7004462 | DE-CIX | Frankfurt/DE |
| RRC13 | 1314165 | 4778407 | MSK/IX | Moscow/RU |
| RRC14 | 663323 | 3371273 | PAIX | Palo Alto/US |
| RRC15 | 1896335 | 12324785 | PTTMetro-SP | São Paulo/BR |
| RRC16 | 259672 | 977813 | NOTA | Miami/US |
| RRC18 | 84222 | 278400 | CATNIX | Barcelona/ES |
| RRC19 | 437222 | 1820852 | NAP/JB | Johannesburg/ZA |
| RRC20 | 2015867 | 7900807 | SwissIX | Zurich/CH |
| RRC21 | 1607568 | 7520597 | FranceIX | Paris/FR |

The last dataset corresponds to data on Route Origin Authorizations (ROA). This will be used as a base of comparison against BGPSECx. ROAs are digital certificates that associate a network prefix (IP address block) with a given ASN (AS number) They are supported by the Resource Public Key Infrastructure (RPKI) and its creation requires a registration process. The ROA database is maintained by Regional Internet Registries (RIRs). To generate this dataset we make use of a RIPE NCC tool called the RPKI Validator 1 . This tool enables the retrieval of all from the the five RIRs to form this dataset. Each line in this dataset reflects a announced prefix. If we have per announce four prefix in NLRI, it will to corresponds four lines. For future reference, this dataset is referred to as **ROA-dataset**.

## Prerequisites to make the evaluation

To start the simulation you needs to have a Unix-like operation system or similar environment with resorces below:

- Java JRE 8 or higher ro run JAR files.
- Gnuplot application to plot chart from CSV file generated by the simulation tests.
- Git application to download the BGPSecX datasets and java codes from repository.
- BGPSecX applications and datasets from repository. Due the Routing-dataset to be very large (around 260 Mbytes), we don't put it in the git. Below we get it from using "wget" application.

For reference, the simulations tests was made in a Ubuntu 16.04 and the instalation procedures of artefacts above can be done as below (we consider the home user as the work directory and symbol "$" is the bash prompt):

```sh
$ cd ~
$ sudo apt-get install oracle-java8-installer gnuplot git unzip wget
$ git clone https://www.github.com/netx-ulx/BGPSecX
$ cd BGPSecX/evaluation/datasets
$ wget https://goo.gl/45cicr
```

## Evaluation tests 
### Origin Authetication, Path-validation and Path-end Validation
Done the environment, to start the simulation test we need the files below from BGPSecX repository:

- IXP-Dataset (datasets/peering_4147_asn.txt) and Routing-dataset (datasets/rrc**xx**_20160901.path, where xx is the number of dataset. First, need decompress it).
- Java code to process simulation algorithm and its configuration file (java/jar/BgpSecXValidator and cfg/validate.cfg).
- Java code to plot chart and its configuration file (java/jar/BgpSecXChartPlot and cfg/chatplot.cfg).

Procedures to start validation:

```sh
$ cd ~
$ cd BGPSecX
$ unzip evaluation/datasets/ris_peering_datasets.zip -d datasets
$ java -jar evaluation/java/jar/BgpSecXValidator.jar evaluation/cfg/validate.cfg 3
```

The last command above process all validations, i.e., Origin Authetication, Path-validation and Path-end Validation. But, you may to process one of a time, only changing the last parameter. the sintaxe of applications is:

***java -jar BGPSecXPlotGrouped.jar <cfg_path> <type_val>***

First parameter must be the path/name of configuration file. In the configuration file, the first line must be the file path of IXP-dataset, and in each others lines, the file path of each Routing-dataset files. Second one must be the type of validation like 0=OA, 1=PV, 2=PEV or 3=ALL.

Finished validations, the generated CSVs files are stored in a new path called "csv". The files are named as rrc**xx**_20160901_**yy**.csv, where xx is the number of routing dataset and yy is the type of validations, i.e., oa, pv or pev. After this, we may to plot the chart as below:

```sh
$ java -jar evaluation/java/jar/BgpSecXChartPlot.jar evaluation/cfg/chatplot.cfg 3 6
```

The sintaxe of last command is:

***java -jar BGPSecXPlotGrouped.jar <cfg_path> <type_val> <#data_per_chart>***

First parameter must be the path/name of configuration file. Second one must be the type of validation like 0=OA, 1=PV, 2=PEV or 3=ALL. Third one must be the number of datasets per chart. Charts are generated in folder caled charts.

### RPKI Validation

This validation will be used as a base of comparison against BGPSecX. to start the simulation test we need the files below from BGPSecX repository:

- ROA-Dataset (datasets/roa_rpki_validator_20170701.json - it was exported from RIPE RPKI Validator tool) and Routing-dataset (datasets/rrc**xx**_20160901.rpki, where xx is the number of dataset. It was decompressed in previous, but if not, need decompress it).
- Java code to process simulation algorithm and its configuration file (java/jar/BgpSecXRpkiValidator and cfg/rpki_validate.cfg)
- A bash script to run gnuplot application to generate the charts (gnuplot/BgpSecXChartPlot).

Procedures to start validation:

```sh
$ cd ~
$ cd BGPSecX
$ java -jar evaluation/java/jar/BgpSecXRpkiValidator.jar evaluation/cfg/rpki_validate.cfg
```

The last command above process RPKI validations according the datasets present in configuration file. The sintaxe is simple and need as parameter only the path of configuration file. In the configuration file, the first line must be the file path of ROA-dataset, and in each others lines, the file path of each Routing-dataset files.

As this task spend more time than previous validation, we can run many times the last command. However, it needs to have one configuration file for each execution, and in each configuration file we put a wanted Routing-dataset. This comes to improve the use of computation resources, once which the java application don't implement multithread to validation multiples datasets.

Finished validations, the generated CSVs files are stored in a new path (or already existing) called "csv". The files are named as rpki_gnuplot_**x**-**y**.csv, where x is the number of file and y the total of files. After this, we may to plot the chart as below:

```sh
$ evaluation/gnuplot/plot_rpki_chart.sh <path/csv_file>
```

**path/csv_file** is the path of CSV file generated by previous validation process. Charts are generated in folder caled charts. Each chart can have up to 6 datasets. 

## Final remarks

That is all. However we observe which the processing time of validations depends of computation resource. Normaly, for OA, PV and PEV is about 1-hour for a x86/I7 single core. But for the OA-RPKI simulation, the time can reach days if simulation is done for all datasets using a single process.













